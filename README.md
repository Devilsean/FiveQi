# 五子棋联机对战系统

一个基于 Java Swing 的五子棋联机对战游戏，支持多人在线对战、观战和房间管理功能。

## 功能特性

### 核心功能

- ✅ **联机对战**：支持多人在线对战
- ✅ **房间系统**：创建房间、加入房间、快速匹配
- ✅ **席位管理**：黑棋席、白棋席、观战席自由切换
- ✅ **实时聊天**：房间内聊天功能
- ✅ **游戏状态同步**：实时同步棋盘状态
- ✅ **连续对战**：游戏结束后可在同一房间继续对战

### 游戏规则

- 15x15 标准五子棋棋盘
- 黑棋先手
- 五子连线获胜
- 棋盘下满平局

### 房间管理

- 房间ID：4位数字（1000-9999）
- 支持创建房间、快速加入、指定ID加入
- 房间列表实时更新
- 空房间自动清理（10秒检查一次）

## 项目结构

```
FiveQi/
├── src/
│   ├── client/          # 客户端代码
│   │   ├── Client.java           # 网络客户端
│   │   ├── GameGUI.java          # 游戏界面
│   │   ├── RoomLobbyGUI.java     # 房间大厅
│   │   ├── MainMenu.java         # 主菜单
│   │   ├── LocalGameGUI.java     # 本地对战
│   │   └── NetworkHandler.java   # 网络消息处理接口
│   ├── server/          # 服务器代码
│   │   ├── Server.java           # 服务器主类
│   │   ├── ClientHandler.java    # 客户端处理器
│   │   ├── GameSession.java      # 游戏会话
│   │   └── ChessRule.java        # 游戏规则引擎
│   └── common/          # 公共代码
│       └── Protocol.java         # 通信协议
├── bin/                 # 编译输出目录
├── compile.bat          # 编译脚本
├── run_server.bat       # 启动服务器脚本
├── run_client.bat       # 启动客户端脚本
└── README.md            # 项目说明文档
```

## 快速开始

### 环境要求

- JDK 8 或更高版本
- Windows 操作系统（批处理脚本）

### 编译项目

```bash
compile.bat
```

### 启动服务器

```bash
run_server.bat
```

服务器默认监听端口：8888

### 启动客户端

```bash
run_client.bat
```

## 使用说明

### 1. 登录

- 启动客户端后输入用户名
- 连接到服务器（默认 localhost:8888）

### 2. 房间操作

- **创建房间**：创建新房间，自动进入观战席
- **快速加入**：随机加入一个可用房间
- **输入ID加入**：通过房间ID加入指定房间
- **刷新列表**：更新房间列表

### 3. 游戏流程

1. 进入房间后，默认在观战席
2. 点击"坐下黑棋席"或"坐下白棋席"选择对战席位
3. 黑白席都有人后，任一方可发起对战邀请
4. 对方同意后开始游戏
5. 游戏结束后：
   - 棋盘自动重置
   - 玩家保持在原席位
   - 可以继续发起新对战或离席换人

### 4. 席位切换

- **观战席 → 对战席**：点击"坐下黑棋席"或"坐下白棋席"
- **对战席 → 观战席**：点击"进入观战席"
- **对战席 ↔ 对战席**：先进入观战席，再坐下另一席位

### 5. 聊天功能

- 系统消息区：显示游戏状态、席位变更等系统信息
- 聊天室：玩家之间的聊天消息

## 技术特点

### 架构设计

- **客户端-服务器架构**：集中式服务器管理
- **多线程处理**：每个客户端独立线程
- **事件驱动**：基于消息的通信机制

### 通信协议

- 基于 TCP Socket
- 文本协议，使用 `|` 分隔符
- UTF-8 编码
- 换行符作为消息结束标记

### 数据同步

- **请求-响应模式**：客户端主动请求房间状态
- **推送模式**：游戏状态变化实时推送
- **状态一致性**：服务器维护权威状态

### 房间管理

- 房间持久化：支持多局对战
- 自动清理：空房间定期清理
- 状态跟踪：实时更新房间列表

## 开发说明

### 添加新功能

1. 在 `Protocol.java` 中定义新的协议常量
2. 在 `ClientHandler.java` 中添加服务器端处理逻辑
3. 在 `Client.java` 中添加客户端消息解析
4. 在 `NetworkHandler.java` 中添加接口方法
5. 在 GUI 类中实现具体功能

### 调试技巧

- 查看控制台输出的 DEBUG 信息
- 使用 `System.out.println` 跟踪消息流
- 检查服务器状态（每30秒自动打印）

## 已知问题

- 批处理脚本仅支持 Windows 系统
- 服务器关闭时客户端需要手动重连

## 未来计划

- [ ] 支持悔棋功能
- [ ] 添加游戏回放
- [ ] 实现排行榜系统
- [ ] 支持自定义棋盘大小
- [ ] 添加 AI 对战模式

## 许可证

本项目仅供学习交流使用。

## 联系方式

如有问题或建议，欢迎反馈。
